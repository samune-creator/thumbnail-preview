<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1.0" />
<title>YouTube風サムネプレビュー</title>

<style>
/* === RESET & BASE === */
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0;}
body{font-family:"Segoe UI",Roboto,Helvetica,Arial,sans-serif;background:#fff;color:#111;line-height:1.4;}
.top-wrap,.bottombar{display:none;}

/* === CONTROLS === */
h1{font-size:1.3rem;font-weight:600;margin:1rem;}
body.mobile-only h1{margin-top:96px;}           /* 内部ヘッダー分 */
.controls{display:flex;flex-wrap:wrap;gap:.75rem;align-items:center;margin:1rem;}
body.mobile-only .controls>*:not(.view-toggle){display:none;} /* スマホでトグルだけ残す */
button{cursor:pointer;border:none;border-radius:6px;padding:.5rem 1rem;font-weight:600;background:#1976d2;color:#fff;transition:transform .15s;}
button:hover{transform:translateY(-2px);}button.active{background:#c62828;}
input[type=text],.edit-input{padding:.35rem .5rem;border:1px solid #ccc;border-radius:6px;}
.edit-input{width:90%;font-size:.9rem;}

/* === MAIN LAYOUT === */
.wrapper{display:flex;gap:2rem;flex-wrap:wrap;justify-content:center;padding-bottom:96px;}/* bottom nav 高さ */
.grid-wrapper{flex:1 1 580px;}
#gallery{display:grid;gap:1rem;padding:1rem;grid-template-columns:repeat(var(--cols,4),1fr);}
.dnd-area{flex:1 1 220px;min-height:52px;display:flex;align-items:center;justify-content:center;background:#fff;border:2px dashed #bbb;border-radius:8px;color:#777;transition:border .25s;cursor:pointer;}
.dnd-area.dragover{border-color:#1976d2;color:#1976d2;}
.view-toggle{display:flex;gap:.5rem;margin-left:auto;}

/* === CARD === */
.card{background:#fff;border-radius:12px;overflow:hidden;width:100%;position:relative;}
.card.dragging{opacity:.35;transform:scale(.98);} .card[draggable=true]{cursor:grab;}
.thumb-wrapper{position:relative;width:100%;aspect-ratio:16/9;display:flex;align-items:center;justify-content:center;background:#e0e0e0;overflow:hidden;border-radius:12px;}
.thumb-wrapper img{width:100%;height:100%;object-fit:cover;}
.duration{position:absolute;bottom:6px;right:6px;font-size:.75rem;padding:0 .25rem;background:rgba(0,0,0,.8);color:#fff;border-radius:4px;}
.meta{padding:.6rem .8rem;display:flex;gap:.6rem;}
.avatar{width:36px;height:36px;border-radius:50%;background:#000;flex-shrink:0;}
.info{flex:1 1 auto;min-width:0;}
.title{font-size:.95rem;font-weight:600;line-height:1.3;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden;}
.channel,.stats{font-size:.78rem;color:#606060;} .channel{margin-bottom:.1rem;}
.placeholder .thumb-wrapper{background:#e0e0e0;} .placeholder .meta{display:none;}

/* === PHONE PREVIEW === */
.phone-container{flex:0 0 400px;display:flex;justify-content:center;align-items:flex-start;padding-top:.5rem;margin-bottom:2.5rem;}
.phone-shell{width:360px;height:720px;border-radius:32px;background:#000;box-shadow:0 6px 12px rgba(0,0,0,.35);padding:20px;position:relative;}
.speaker{width:80px;height:6px;background:#333;border-radius:3px;position:absolute;top:14px;left:50%;transform:translateX(-50%);}
.phone-screen{width:100%;height:100%;background:#fff;border-radius:24px;display:flex;flex-direction:column;overflow:hidden;}
.phone-head{position:sticky;top:0;z-index:2;background:#fff;transition:transform .25s ease;} .phone-head.hidden{transform:translateY(-100%);}
.phone-topbar{height:48px;background:#fff;border-bottom:1px solid #ddd;}
.phone-content{flex:1 1 auto;overflow-y:auto;scrollbar-width:thin;background:#fff;}
.phone-content::-webkit-scrollbar{width:6px;} .phone-content::-webkit-scrollbar-thumb{background:#bbb;border-radius:3px;}
.phone-bnav{height:96px;background:#fff;border-top:1px solid #ccc;position:sticky;bottom:0;z-index:2;}

/* === VISIBILITY === */
body.pc-only .grid-wrapper{display:block;} body.pc-only .phone-container{display:none;}
body.mobile-only .grid-wrapper{display:none;} body.mobile-only .phone-container{display:flex;}
@media(max-width:800px){.wrapper{flex-direction:column;align-items:center;}.grid-wrapper{flex:1 1 100%;}.phone-container{flex:0 0 320px;}}
</style>
</head>
<body class="pc-only">

<h1>YouTube風サムネプレビュー</h1>
<div class="controls">
  <label>タイトル(任意):<input id="titleInput" type="text" placeholder="例: 新機能紹介！"></label>
  <div id="dnd" class="dnd-area">サムネ画像をドラッグ＆ドロップ (またはクリック選択)</div>
  <input id="fileInput" type="file" accept="image/*" hidden>
  <button id="addBtn">追加</button>
  <label>列数:<input id="colRange" type="range" min="1" max="6" value="4"></label>
  <div class="view-toggle"><button id="pcBtn" class="active">PC表示</button><button id="spBtn">スマホ表示</button></div>
</div>

<div class="wrapper">
  <div class="grid-wrapper"><div id="gallery"></div></div>
    <div class="phone-container">
    <div class="phone-shell"><span class="speaker"></span>
      <div id="phoneScreen" class="phone-screen">
        <div id="phoneHead" class="phone-head"><div class="phone-topbar"></div></div>
        <div id="phoneContent" class="phone-content"></div>
        <div class="phone-bnav"></div>
      </div>
    </div>
  </div>
</div><!-- /wrapper -->

<!-- ===== SCRIPT ===== -->
<script>
/* === CONSTS & ELEMENTS === */
const SLOT = 16;   /* プレースホルダー数 */
const randomTitles = ["おすすめ神アプリ","衝撃の事実","知らないと損","便利サイトTOP10",
                      "完全攻略ガイド","最新機能解説","絶対に入れるべき",
                      "裏技公開","秒で解決","初心者必見"];

const $ = s => document.querySelector(s);
const gallery      = $('#gallery');
const phoneContent = $('#phoneContent');

/* === PLACEHOLDERS (index 0-15) === */
for(let i=0;i<SLOT;i++){
  const ph=document.createElement('div');
  ph.className='card placeholder'; ph.dataset.index=i;
  ph.innerHTML='<div class="thumb-wrapper"></div><div class="meta"></div>';
  gallery.appendChild(ph);
  phoneContent.appendChild(ph.cloneNode(true));
}
/* === FILE INPUT & D&D === */
const dnd=$('#dnd'),fileInput=$('#fileInput');
dnd.onclick=()=>fileInput.click();
fileInput.onchange=e=>handleFile(e.target.files[0]);

dnd.addEventListener('dragover',e=>(e.preventDefault(),dnd.classList.add('dragover')));
dnd.addEventListener('dragleave',()=>dnd.classList.remove('dragover'));
dnd.addEventListener('drop',e=>{e.preventDefault();dnd.classList.remove('dragover');if(e.dataTransfer.files.length)handleFile(e.dataTransfer.files[0]);});

/* placeholder D&D */
document.addEventListener('dragover',e=>{if(e.target.closest('.placeholder')) e.preventDefault();});
document.addEventListener('drop',e=>{
  const slot=e.target.closest('.placeholder');
  if(slot && e.dataTransfer.files.length){
    e.preventDefault(); handleFile(e.dataTransfer.files[0],slot);
  }
});

$('#addBtn').onclick=()=>alert('灰色の空枠に画像をドロップして追加してください');

/* === CARD HELPERS === */
function cardHTML(d){
  return `<div class="thumb-wrapper"><img src="${d.src}"><span class="duration">0:00</span></div>
          <div class="meta"><div class="avatar"></div><div class="info">
            <div class="title">${d.title}</div>
            <div class="channel">MyChannel</div>
            <div class="stats">1234 回視聴 ・ 1ヶ月前</div>
          </div></div>`;
}

function matchingPhone(pc){
  return phoneContent.querySelector(`.placeholder[data-index='${pc.dataset.index}'], .card[data-index='${pc.dataset.index}']`);
}

function setCard(pc,d,intv){
  pc.classList.remove('placeholder');
  pc.dataset.id=d.id; pc.innerHTML=cardHTML(d);

  const sp=matchingPhone(pc);
  if(sp){ sp.classList.remove('placeholder'); sp.dataset.id=d.id; sp.innerHTML=cardHTML(d); }

  if(intv){ enableDrag(pc); enableEdit(pc); }
}

function addCard(d){
  const ph=gallery.querySelector('.placeholder');
  if(ph){ setCard(ph,d,true); }
  else {                                 /* 追加枠（17個目以降） */
    const idx=gallery.querySelectorAll('.card').length;
    const pc=document.createElement('div'); pc.className='card'; pc.dataset.index=idx; pc.dataset.id=d.id; pc.innerHTML=cardHTML(d);
    gallery.appendChild(pc); enableDrag(pc); enableEdit(pc);

    const sp=pc.cloneNode(true);
    phoneContent.appendChild(sp);
  }
}

function handleFile(file,slot=null){
  if(!file) return;
  const reader=new FileReader();
  reader.onload=e=>{
    const data={id:Date.now().toString(36)+Math.random().toString(36).slice(2),
                title:($('#titleInput').value.trim()||randomTitles[Math.floor(Math.random()*randomTitles.length)]),
                src:e.target.result};
    slot ? setCard(slot,data,true) : addCard(data);
  };
  reader.readAsDataURL(file);
}

/* === DRAG & REORDER === */
let dragSrc=null;
function enableDrag(c){
  c.draggable=true;
  c.ondragstart=()=>{dragSrc=c;c.classList.add('dragging');};
  c.ondragend  =()=>{c.classList.remove('dragging');dragSrc=null;};
  c.ondragover =e=>e.preventDefault();
  c.ondrop     =e=>{e.preventDefault();if(!dragSrc||dragSrc===c)return;swapCards(dragSrc,c);};
}
function swapCards(a,b){
  const p=a.parentNode,next=a.nextSibling===b?a:a.nextSibling;
  p.insertBefore(a,b); p.insertBefore(b,next);

  const pa=matchingPhone(a), pb=matchingPhone(b);
  if(pa&&pb){
    const pp=pa.parentNode,next2=pa.nextSibling===pb?pa:pa.nextSibling;
    pp.insertBefore(pa,pb); pp.insertBefore(pb,next2);
  }
}

/* === INLINE EDIT === */
function enableEdit(c){
  const t=c.querySelector('.title');
  t.ondblclick=()=>{
    if(document.body.classList.contains('mobile-only')) return;
    const old=t.textContent;
    const inp=document.createElement('input'); inp.className='edit-input'; inp.value=old;
    let comp=false; inp.oncompositionstart=()=>comp=true; inp.oncompositionend=()=>comp=false;
    const fin=s=>{const v=s&&inp.value.trim()?inp.value.trim():old;
      const nt=document.createElement('div'); nt.className='title'; nt.textContent=v;
      inp.replaceWith(nt); enableEdit(c);
      matchingPhone(c).querySelector('.title').textContent=v;};
    inp.onkeydown=e=>{if(e.key==='Enter'&&!comp)fin(true); if(e.key==='Escape')fin(false);};
    inp.onblur=()=>fin(true);
    t.replaceWith(inp); inp.focus(); inp.select();
  };
}

/* 列スライダー */
$('#colRange').oninput=e=>document.body.style.setProperty('--cols',e.target.value);
document.body.style.setProperty('--cols',$('#colRange').value);
/* === MODE TOGGLE === */
$('#pcBtn').onclick=()=>{document.body.className='pc-only';$('#pcBtn').classList.add('active');$('#spBtn').classList.remove('active');};
$('#spBtn').onclick=()=>{document.body.className='mobile-only';$('#spBtn').classList.add('active');$('#pcBtn').classList.remove('active');};

/* === HIDE TOPBAR ON SCROLL === */
const phoneScreen=$('#phoneScreen'), phoneHead=$('#phoneHead'); let lastY=0;
phoneScreen.addEventListener('scroll',()=>{
  const y=phoneScreen.scrollTop;
  if(y>lastY && y>80) phoneHead.classList.add('hidden');
  else phoneHead.classList.remove('hidden');
  lastY=y;
});
</script>
</body>
</html>